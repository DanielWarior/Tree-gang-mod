
[core]
name: testudo
class: CustomUnitMetadata
price: 2300
maxHp: 2500
armour:6
mass: 10000

techLevel: 2

copyFrom:ROOT:Templates\customEffects.template

displayText: Testudo transport 
displayDescription: -Dominion's heavy infatry transport tank\n- Can carry 8 infantry units \n- units use mounted guns to fire from the sides of the tank\n-units inside survive upopn tank being destroyed

buildSpeed: 40s

radius: 27

isBio: false

maxTransportingUnits: 8
transportUnitsRequireTag:infantry
transportUnitsRequireMovementType: LAND,OVER_CLIFF,HOVER
transportUnitsKillOnDeath: if self.isOverLiquid()

exit_x:0
exit_y:34

transportUnitsUnloadDelayBetweenEachUnit:8

exit_dirOffset:-180
exit_moveAwayAmount:20



[graphics]
total_frames: 4

teamColorsOnTurret: true

image:        testudo.png
image_wreak:  testudo_wreck.png
image_turret: testudo_turret_base.png

image_shadow: AUTO
shadowOffsetX:1
shadowOffsetY:1

animation_moving_start: 0
animation_moving_end: 3
animation_moving_speed: 2

dustEffect: true


[attack]
canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits:   true
canAttackUnderwaterUnits: false

turretSize: 15
turretTurnSpeed: 4
maxAttackRange: 200
shootDelay: 160

turretMultiTargeting: true

[hiddenAction_kite]
autoTrigger: if self.isAttacking() and self.isControlledByAI() and self.numberOfUnitsInEnemyTeam(greaterThan=0, withinRange=180)

clearAllWaypoints: true
addWaypoint_target_fromReference: createMarker(x=self.x, y=self.y, dir=direction(self.x, self.y, attacking.x, attacking.y)).getOffsetRelative(y=-90)
addWaypoint_type: move
allowMultipleInQueue: false

[hiddenAction_retreat]
autoTrigger: if self.isControlledByAi() and self.hp(lessThan=190) and not self.tags(includes='retreat')
requireConditional: if self.numberOfUnitsInTeam(withTag='repair', greaterThan=0, withinRange=1000)
temporarilyAddTags: retreat

[hiddenAction_retreating]
autoTrigger: if self.tags(includes='retreat')
requireConditional: if self.numberOfUnitsInTeam(withTag='repair', greaterThan=0, withinRange=1000)
clearAllWaypoints: true
addWaypoint_target_nearestUnit_tagged: repair
addWaypoint_target_nearestUnit_team: own
addWaypoint_type: move
allowMultipleInQueue:false

[hiddenAction_active]
autoTrigger: if self.tags(includes='retreat') and (self.hp() == self.maxHp())
temporarilyRemoveTags: retreat

[turret_2]
x: 0
y: 12

image:testudo_turret_barrel.png

attachedTo:1
slave:true

projectile:1
canShoot:true

recoilOffset:-8
recoilOutTime:10
recoilReturnTime:30

canAttackLandUnits:true
canAttackFlyingUnits:true

shoot_sound:ROOT:sounds\autoCannon_fire_2.wav
shoot_sound_vol:0.20
shoot_flame:small
shoot_light:#FFccCCEE


[turret_1]
x: 0
y: -10

projectile:1
canShoot:false


[turret_1_l]
x: 15
y: 16.5

image:testudo_sidearm.png

projectile:2
canShoot:true

idleDir:90 
limitingRange:190
limitingAngle:45

recoilOffset:-1
recoilOutTime:5
recoilReturnTime:15

canAttackLandUnits:if self.transportingCount(greaterThan=1)
canAttackFlyingUnits:false

warmup:15
delay: 5

shoot_sound:ROOT:sounds\lmg_fire_2.wav
shoot_sound_vol:0.10
shoot_flame:small
shoot_light:#FFccCCEE

[turret_2_l]
x: 15
y: 4.5
copyFrom:1_l

warmup:10
delay: 10

canAttackLandUnits:if self.transportingCount(greaterThan=3)

[turret_3_l]
x: 15
y: -7.5
copyFrom:1_l

warmup:5
delay: 15

canAttackLandUnits:if self.transportingCount(greaterThan=5)

[turret_4_l]
x: 15
y: -19.5
copyFrom:1_l

warmup:0
delay: 20

canAttackLandUnits:if self.transportingCount(greaterThan=7)

[turret_1_r]
x: -15
y: 16.5

image:testudo_sidearm.png

projectile:2
canShoot:true

idleDir:-90 
limitingRange:190
limitingAngle:45

recoilOffset:-1
recoilOutTime:5
recoilReturnTime:15

canAttackLandUnits:if self.transportingCount(greaterThan=2)
canAttackFlyingUnits:false

warmup:15
delay: 5

shoot_sound:ROOT:sounds\lmg_fire_2.wav
shoot_sound_vol:0.10
shoot_flame:small
shoot_light:#FFccCCEE

[turret_2_r]
x: -15
y: 4.5
copyFrom:1_r

warmup:10
delay: 10

canAttackLandUnits:if self.transportingCount(greaterThan=4)

[turret_3_r]
x: -15
y: -7.5
copyFrom:1_r

warmup:5
delay: 15

canAttackLandUnits:if self.transportingCount(greaterThan=6)

[turret_4_r]
x: -15
y: -19.5
copyFrom:1_r

warmup:0
delay: 20

canAttackLandUnits:if self.transportingCount(greaterThan=8)

[projectile_1]
directDamage: 20
areaDamage:50
areaRadius:40

life: 70
speed: 8
frame: 4

[projectile_2]
directDamage: 7
life: 70
speed: 7
frame: 5

drawSize: 0.6

explodeEffect:CUSTOM:bullet_hit


[movement]
movementType: LAND
moveSpeed: 0.9
moveAccelerationSpeed: 0.2
moveDecelerationSpeed: 0.5
reverseSpeedPercentage:0.8

maxTurnSpeed: 2.0
turnAcceleration: 0.65

moveSlidingMode :false
moveIgnoringBody:false
[ai]
useAsTransport:true